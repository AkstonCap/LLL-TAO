#!/bin/bash
#
# run-nexus
#
# Launch Nexus Daemon. Check to see if nexus data directory /root/.TAO needs
# to be created and point to the host OS file system.
#

DATA_DIR="/hostOS$HOSTOS_HOME/.Nexus_Core_Data_BETA"

#
# If this is first innvocation of the nexus daemon after container creation,
# then setup /root/.TAO directory. Point to host OS file system. If that
# directory does not exist, create it and copy a default nexus.conf to it.
#
cd /nexus
if [ ! -d "/root/.TAO" ]; then
    if [ ! -d $DATA_DIR ]; then
        echo -n "Create nexus data directory $DATA_DIR ... "
        mkdir $DATA_DIR
        cp /nexus/nexus.conf.default $DATA_DIR/nexus.conf
        echo "done"
    fi
    echo -n "Symlink nexus data directory /root/.TAO -> $DATA_DIR ... "
    ln -sf $DATA_DIR /root/.TAO
    echo "done"
fi

#
# Startup daemon. Check /root/.TAO/nexus.conf for daemon parameterization.
#
./nexus &
